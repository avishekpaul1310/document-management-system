{% extends 'base.html' %}

{% block content %}
<div class="document-header">
    <h1>Documents</h1>
    <div class="category-filter">
        <label>Filter by category:</label>
        <select onchange="window.location.href='?category=' + this.value">
            <option value="">All Categories</option>
            {% for category in categories %}
                <option value="{{ category.id }}" 
                    {% if current_category|add:"0" == category.id %}selected{% endif %}>
                    {{ category.name }}
                </option>
            {% endfor %}
        </select>
    </div>
</div>

<div class="document-grid">
    {% for document in documents %}
        <div class="document-card">
            <h3>{{ document.title }}</h3>
            <p class="description">{{ document.description|truncatewords:30 }}</p>
            <div class="document-meta">
                <p>Category: {{ document.category.name }}</p>
                <p>Uploaded: {{ document.uploaded_at|date:"Y-m-d H:i" }}</p>
                <p>Owner: {{ document.owner.username }}</p>
                <p>Shared: {{ document.is_shared|yesno:"Yes,No" }}</p>
            </div>
            <div class="document-actions">
                <a href="{% url 'document_detail' document.pk %}" class="btn view-btn">View</a>
                {% if document.owner == user %}
                    <a href="{% url 'document_delete' document.pk %}" 
                       class="btn delete-btn"
                       onclick="return confirm('Are you sure you want to delete this document?')">
                        Delete
                    </a>
                {% endif %}
            </div>
        </div>
    {% empty %}
        <p class="no-documents">No documents found.</p>
    {% endfor %}
</div>
{% endblock %}